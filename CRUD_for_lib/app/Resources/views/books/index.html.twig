{% extends 'base_bootstrap.html.twig' %}
{% block JSHead %}
    <script>
        function changeAuthor(authorId, bookId) {
            const newAuthorName = document.getElementById(authorId.toString() + bookId.toString() + '_name').value;
            const newAuthor2Name = document.getElementById(authorId.toString() + bookId.toString() + '_2name').value;
            const Http = new XMLHttpRequest();
            const url='http://127.0.0.1:8000/authors/changeName/' + authorId + '/' + newAuthorName + '/' + newAuthor2Name;
            Http.open("GET", url);
            Http.send();
        }

        function addAuthor(bookId) {
            const newName = prompt("Enter Author Name:");
            const newSecondNAme = prompt("Enter Author Second Name:");
            const Http = new XMLHttpRequest();
            const url='http://127.0.0.1:8000/books/addAuthor/' + bookId + '/' + newName + '/' + newSecondNAme;
            Http.open("GET", url);
            Http.send();
        }
    </script>
{% endblock %}

{% block body %}
    <h1>Books list</h1>

    <table class="table table-dark">
        <thead>
            <tr>
                <th scope = "col">Id</th>
                <th scope = "col">Title</th>
                <th scope = "col">Description</th>
                <th scope = "col">Image</th>
                <th scope = "col">Realise date</th>
                <th scope = "col">Authors</th>
            </tr>
        </thead>
        <tbody>
        {% for book in books %}
            <tr>
                <th scope = "row"><a href="{{ path('books_show', { 'bookId': book.bookId }) }}">{{ book.bookId }}</a></th>
                <td>{{ book.bookName }}</td>
                <td>{{ book.bookDesc }}</td>
                <td>{{ book.bookImg }}</td>
                <td>{% if book.bookPubDate %}{{ book.bookPubDate|date('Y-m-d H:i:s') }}{% endif %}</td>
                <td>
                    <ul>
                        {% for author in book.author %}
                            <li>
                                <input type="text" value="{{ author.getAuthorName }}" id="{{ author.getAuthorId }}{{ book.getBookId }}_name">
                                <input type="text" value="{{ author.getAuthorSecondName }}" id="{{ author.getAuthorId }}{{ book.getBookId }}_2name">
                                <button  onclick="changeAuthor({{ author.getAuthorId }}, {{ book.getBookId }})">Change Author</button>
                            </li>
                        {% endfor %}
                    </ul>
                    <input type="button" value="Add Co-Author" onclick="addAuthor({{ book.getBookId }})">
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    
{% endblock %}
